[start]
command:/usr/local/opnsense/scripts/OPNsense/GatewayExporter/generate_config.php && /usr/sbin/daemon -f -p /var/run/gateway_exporter.pid -u nobody /usr/local/opnsense/scripts/OPNsense/GatewayExporter/gateway_exporter.php
parameters:
type:script
message:Starting Gateway Exporter

[stop]
command:/bin/pkill -F /var/run/gateway_exporter.pid 2>/dev/null; rm -f /var/run/gateway_exporter.pid; exit 0
parameters:
type:script
message:Stopping Gateway Exporter

[restart]
command:/bin/pkill -F /var/run/gateway_exporter.pid 2>/dev/null; rm -f /var/run/gateway_exporter.pid; sleep 1; /usr/local/opnsense/scripts/OPNsense/GatewayExporter/generate_config.php && /usr/sbin/daemon -f -p /var/run/gateway_exporter.pid -u nobody /usr/local/opnsense/scripts/OPNsense/GatewayExporter/gateway_exporter.php
parameters:
type:script
message:Restarting Gateway Exporter

[reconfigure]
command:/usr/local/opnsense/scripts/OPNsense/GatewayExporter/generate_config.php && /bin/pkill -HUP -F /var/run/gateway_exporter.pid 2>/dev/null; exit 0
parameters:
type:script
message:Reconfiguring Gateway Exporter

[gateway-status]
command:/usr/local/opnsense/scripts/OPNsense/GatewayExporter/gateway_status.php
parameters:
type:script_output
message:Fetching gateway metrics

[status]
command:if [ -f /var/run/gateway_exporter.pid ] && /bin/pgrep -qF /var/run/gateway_exporter.pid 2>/dev/null; then echo "gateway_exporter is running as pid $(cat /var/run/gateway_exporter.pid)."; else echo "gateway_exporter is not running."; fi
parameters:
type:script_output
message:Checking Gateway Exporter status
